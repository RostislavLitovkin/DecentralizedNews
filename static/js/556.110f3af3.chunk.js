(self.webpackChunkapp=self.webpackChunkapp||[]).push([[556],{16615:function(n,r,t){"use strict";var e=t(65734).Buffer;n.exports=function(n){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),t=0;t<r.length;t++)r[t]=255;for(var i=0;i<n.length;i++){var a=n.charAt(i),o=a.charCodeAt(0);if(255!==r[o])throw new TypeError(a+" is ambiguous");r[o]=i}var s=n.length,c=n.charAt(0),u=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function f(n){if("string"!==typeof n)throw new TypeError("Expected String");if(0===n.length)return e.alloc(0);for(var t=0,i=0,a=0;n[t]===c;)i++,t++;for(var o=(n.length-t)*u+1>>>0,l=new Uint8Array(o);n[t];){var f=r[n.charCodeAt(t)];if(255===f)return;for(var p=0,h=o-1;(0!==f||p<a)&&-1!==h;h--,p++)f+=s*l[h]>>>0,l[h]=f%256>>>0,f=f/256>>>0;if(0!==f)throw new Error("Non-zero carry");a=p,t++}for(var d=o-a;d!==o&&0===l[d];)d++;var g=e.allocUnsafe(i+(o-d));g.fill(0,0,i);for(var w=i;d!==o;)g[w++]=l[d++];return g}return{encode:function(r){if((Array.isArray(r)||r instanceof Uint8Array)&&(r=e.from(r)),!e.isBuffer(r))throw new TypeError("Expected Buffer");if(0===r.length)return"";for(var t=0,i=0,a=0,o=r.length;a!==o&&0===r[a];)a++,t++;for(var u=(o-a)*l+1>>>0,f=new Uint8Array(u);a!==o;){for(var p=r[a],h=0,d=u-1;(0!==p||h<i)&&-1!==d;d--,h++)p+=256*f[d]>>>0,f[d]=p%s>>>0,p=p/s>>>0;if(0!==p)throw new Error("Non-zero carry");i=h,a++}for(var g=u-i;g!==u&&0===f[g];)g++;for(var w=c.repeat(t);g<u;++g)w+=n.charAt(f[g]);return w},decodeUnsafe:f,decode:function(n){var r=f(n);if(r)return r;throw new Error("Non-base"+s+" character")}}}},1141:function(n,r,t){var e=t(16615);n.exports=e("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},54556:function(n,r,t){"use strict";t.r(r),t.d(r,{StrikeWallet:function(){return h}});var e=t(74165),i=t(15861),a=t(93433),o=t(15671),s=t(43144),c=t(4908),u=t(1141),l=t(18248),f=t(40918).Buffer,p=f.alloc(c.SIGNATURE_LENGTH_IN_BYTES).fill(0),h=function(){function n(){var r=this;(0,o.Z)(this,n),this.url="https://wallet.strikeprotocols.com",this.cleanUp=function(){(0,a.Z)(r._timers).forEach((function(n){return r.clearTimer(n)}));var n=r._wallet;n&&n.close(),r._wallet=null},this.clearTimer=function(n){r._timers=r._timers.filter((function(r){return r!=n})),window.clearInterval(n)},this.instructionsToSerializableInstructions=function(n){return n.map((function(n){return{programId:n.programId.toBase58(),accountMetas:n.keys.map((function(n){return{address:n.pubkey.toBase58(),signer:n.isSigner,writable:n.isWritable}})),data:window.btoa(String.fromCharCode.apply(String,(0,a.Z)(n.data)))}}))},this.handleWalletMessage=function(n){var t,e,i;if("connected"==n.type)r._connecting=!1,n.error||(r.isLoggedIn=!0,(null===(t=n.connected)||void 0===t?void 0:t.publicKey)&&(r._publicKey=new c.PublicKey(n.connected.publicKey)));else if(["sendTransaction","sendFinalTransaction"].includes(n.type)){var a=null===(e=n.sendTransaction)||void 0===e?void 0:e.identifier;a&&a in r._pendingTransactions&&(n.error?r._pendingTransactionErrors[a]=new Error(n.error):r._pendingTransactions[a]=n.sendTransaction||null)}else if("signTransaction"==n.type){var o=null===(i=n.signTransaction)||void 0===i?void 0:i.identifier;o&&o in r._pendingTransactions&&(n.error?r._pendingTransactionErrors[o]=new Error(n.error):r._pendingTransactions[o]=n.signTransaction||null)}},this.isLoggedIn=!1,this._pendingTransactions={},this._pendingTransactionErrors={},this._timers=[],this._wallet=null,this._connecting=!1,this._publicKey=null,window.addEventListener("message",(function(n){r.handleWalletMessage(n.data)}))}return(0,s.Z)(n,[{key:"connect",value:function(){var n=(0,i.Z)((0,e.Z)().mark((function n(r){var t,i,a=this;return(0,e.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,this.url=r||this.url,t=encodeURIComponent(window.location.origin),i="".concat(this.url,"/connect?origin=").concat(t),this._connecting=!0,this._wallet=window.open(i,"strike-wallet-".concat(t),"height=800,width=800,menubar=no,status=no,toolbar=no"),this._wallet){n.next=9;break}throw this._connecting=!1,new Error("Unable to connect to wallet");case 9:return this._timers.push(window.setInterval((function(){a._wallet.closed?a.cleanUp():a._wallet&&a._wallet.postMessage({type:"heartbeat"},a.url)}),100)),n.abrupt("return",new Promise((function(n,r){var t=window.setInterval((function(){a.isLoggedIn&&a._publicKey?(a.clearTimer(t),n(a._publicKey)):a.isLoggedIn||a._connecting||(a.clearTimer(t),r(new Error("Unable to connect to Strike")))}),100);a._timers.push(t)})));case 13:throw n.prev=13,n.t0=n.catch(0),n.t0;case 16:case"end":return n.stop()}}),n,this,[[0,13]])})));return function(r){return n.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var n=(0,i.Z)((0,e.Z)().mark((function n(r){return(0,e.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.verifyCanSignRequests([r]),n.prev=1,n.abrupt("return",this.signOneTransaction(r));case 5:throw n.prev=5,n.t0=n.catch(1),n.t0;case 8:case"end":return n.stop()}}),n,this,[[1,5]])})));return function(r){return n.apply(this,arguments)}}()},{key:"signAllTransactions",value:function(){var n=(0,i.Z)((0,e.Z)().mark((function n(r){var t=this;return(0,e.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.verifyCanSignRequests(r),n.prev=1,n.abrupt("return",Promise.all(r.map((function(n){return t.signOneTransaction(n)}))));case 5:throw n.prev=5,n.t0=n.catch(1),n.t0;case 8:case"end":return n.stop()}}),n,this,[[1,5]])})));return function(r){return n.apply(this,arguments)}}()},{key:"sendTransaction",value:function(){var n=(0,i.Z)((0,e.Z)().mark((function n(r,t,i){var o,s,c,u,f=this;return(0,e.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,o=this._wallet){n.next=4;break}throw new Error("Not Connected");case 4:if(s=(0,l.Z)(),this._pendingTransactions[s]=null,!((c=i?i.signers:void 0)&&c.length>0)){n.next=11;break}return n.abrupt("return",new Promise((function(n,t){f.signOneTransaction(r,s).then((function(r){f._pendingTransactions[s]=null,(null===c||void 0===c?void 0:c.length)&&r.partialSign.apply(r,(0,a.Z)(c)),o.postMessage({type:"sendFinalTransaction",sendFinalTransaction:{transactionIdentifier:s,signaturePubkeyPairs:r.signatures.filter((function(n){return null!=n.signature})).map((function(n){return{pubkey:n.publicKey.toBase58(),signature:n.signature.toString("base64")}}))}},f.url);var e=window.setInterval((function(){var r=f._pendingTransactions[s],i=f._pendingTransactionErrors[s];null==r&&null==i||(f.clearTimer(e),r&&n(r.signature),i&&t(i))}),100);f._timers.push(e)})).catch((function(n){throw t(n),n}))})));case 11:return u=this.instructionsToSerializableInstructions(r.instructions),n.abrupt("return",new Promise((function(n,r){o.postMessage({type:"sendTransaction",sendTransaction:{instructions:u,transactionIdentifier:s}},f.url);var t=window.setInterval((function(){var e=f._pendingTransactions[s],i=f._pendingTransactionErrors[s];null==e&&null==i||(f.clearTimer(t),e&&n(e.signature),i&&r(i))}),100);f._timers.push(t)})));case 13:n.next=18;break;case 15:throw n.prev=15,n.t0=n.catch(0),n.t0;case 18:case"end":return n.stop()}}),n,this,[[0,15]])})));return function(r,t,e){return n.apply(this,arguments)}}()},{key:"buildTransaction",value:function(n){var r=c.Message.from(f.from(Uint8Array.from(window.atob(n.message),(function(n){return n.charCodeAt(0)}))));return c.Transaction.populate(r,Array.from({length:r.header.numRequiredSignatures},(function(t,e){var i=n.signatures.find((function(n){return n.pubkey==r.accountKeys[e].toBase58()}));return u.encode(i?f.from(Uint8Array.from(window.atob(i.signature),(function(n){return n.charCodeAt(0)}))):p)})))}},{key:"verifyCanSignRequests",value:function(n){n.forEach((function(n){if(n.signatures.some((function(n){return null!=n.signature})))throw new Error("Strike does not support this signing mode")}))}},{key:"signOneTransaction",value:function(n){var r=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,l.Z)(),e=this._wallet;if(!e)throw new Error("Not Connected");var i=this.instructionsToSerializableInstructions(n.instructions);return this._pendingTransactions[t]=null,new Promise((function(n,a){e.postMessage({type:"signTransaction",signTransaction:{instructions:i,transactionIdentifier:t}},r.url);var o=window.setInterval((function(){var e=r._pendingTransactions[t],i=r._pendingTransactionErrors[t];null==e&&null==i||(r.clearTimer(o),e&&n(r.buildTransaction(e)),i&&a(i))}),100);r._timers.push(o)}))}}]),n}()}}]);